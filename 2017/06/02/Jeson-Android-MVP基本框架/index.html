<!DOCTYPE html>
<html>
<head>
    
<!-- Google Analytics -->
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'true', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<!-- End Google Analytics -->


    

    



    <meta charset="utf-8">
    
    <meta name="google-site-verification" content="true">
    
    
    
    <title>Jeson Android MVP | 学习笔记 | BIUBIUBIU...</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="java,MVP">
    <meta name="description" content="MVP简介MVP演化自MVC, 全称为 Model View Presenter.
特点
将业务逻辑与界面解耦
提升可扩展性, 可测试性, 整洁性和灵活性
M V P三层之间使用接口进行通信, 可以独立变化, 理想化情况是依赖接口实现不同(相同)逻辑适配相同(不同)的界面
使类的职责更加单一, 更易于维护

MVP架构以技术公司的客户(View), 销售(Presenter), 研发(Model)">
<meta property="og:type" content="article">
<meta property="og:title" content="Jeson Android MVP">
<meta property="og:url" content="http://jeson.org/2017/06/02/Jeson-Android-MVP基本框架/index.html">
<meta property="og:site_name" content="学习笔记">
<meta property="og:description" content="MVP简介MVP演化自MVC, 全称为 Model View Presenter.
特点
将业务逻辑与界面解耦
提升可扩展性, 可测试性, 整洁性和灵活性
M V P三层之间使用接口进行通信, 可以独立变化, 理想化情况是依赖接口实现不同(相同)逻辑适配相同(不同)的界面
使类的职责更加单一, 更易于维护

MVP架构以技术公司的客户(View), 销售(Presenter), 研发(Model)">
<meta property="og:image" content="http://jeson.org/img/MVP架构示意图.svg">
<meta property="og:image" content="http://jeson.org/img/MVC架构示意图.svg">
<meta property="og:image" content="http://jeson.org/img/MVVM架构示意图.svg">
<meta property="og:image" content="http://jeson.org/img/Jeson_MVP_时序图.svg">
<meta property="og:image" content="http://jeson.org/img/MVP类图.svg">
<meta property="og:updated_time" content="2017-06-04T09:07:15.113Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Jeson Android MVP">
<meta name="twitter:description" content="MVP简介MVP演化自MVC, 全称为 Model View Presenter.
特点
将业务逻辑与界面解耦
提升可扩展性, 可测试性, 整洁性和灵活性
M V P三层之间使用接口进行通信, 可以独立变化, 理想化情况是依赖接口实现不同(相同)逻辑适配相同(不同)的界面
使类的职责更加单一, 更易于维护

MVP架构以技术公司的客户(View), 销售(Presenter), 研发(Model)">
<meta name="twitter:image" content="http://jeson.org/img/MVP架构示意图.svg">
    
        <link rel="alternate" type="application/atom+xml" title="学习笔记" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>
</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">会飞的汉堡包</h5>
          <a href="mailto:zhangjisong@live.com" title="zhangjisong@live.com" class="mail">zhangjisong@live.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                归档
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                分类
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Jeson Android MVP</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Jeson Android MVP</h1>
        <h5 class="subtitle">
            
                <time datetime="2017-06-01T16:00:00.000Z" itemprop="datePublished" class="page-time">
  2017-06-02
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/技术类/">技术类</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#MVP简介"><span class="post-toc-number">1.</span> <span class="post-toc-text">MVP简介</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#特点"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">特点</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#MVP架构"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">MVP架构</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#MVP与MVC和MVVM的区别"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">MVP与MVC和MVVM的区别</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#MVC架构"><span class="post-toc-number">1.3.1.</span> <span class="post-toc-text">MVC架构</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#MVVM架构"><span class="post-toc-number">1.3.2.</span> <span class="post-toc-text">MVVM架构</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Jeson-MVP工作流程"><span class="post-toc-number">2.</span> <span class="post-toc-text">Jeson-MVP工作流程</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#简介"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">简介</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#运行原理"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">运行原理</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#接口和类"><span class="post-toc-number">3.</span> <span class="post-toc-text">接口和类</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#接口"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">接口</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#IBasicModel"><span class="post-toc-number">3.1.1.</span> <span class="post-toc-text">IBasicModel</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#IBasicPresenter"><span class="post-toc-number">3.1.2.</span> <span class="post-toc-text">IBasicPresenter</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#IBasicView"><span class="post-toc-number">3.1.3.</span> <span class="post-toc-text">IBasicView</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#IBasicHandler"><span class="post-toc-number">3.1.4.</span> <span class="post-toc-text">IBasicHandler</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ILifeRecycle"><span class="post-toc-number">3.1.5.</span> <span class="post-toc-text">ILifeRecycle</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#类"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">类</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#BasicPresenter"><span class="post-toc-number">3.2.1.</span> <span class="post-toc-text">BasicPresenter</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#BasicModel"><span class="post-toc-number">3.2.2.</span> <span class="post-toc-text">BasicModel</span></a></li></ol></li></ol></li></ol>
        </nav>
    </aside>
    
<article id="post-Jeson-Android-MVP基本框架"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Jeson Android MVP</h1>
        <div class="post-meta">
            <time class="post-time" title="2017-06-02 00:00:00" datetime="2017-06-01T16:00:00.000Z"  itemprop="datePublished">2017-06-02</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/技术类/">技术类</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


            

        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="MVP简介"><a href="#MVP简介" class="headerlink" title="MVP简介"></a>MVP简介</h1><p>MVP演化自MVC, 全称为 Model View Presenter.</p>
<h2 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h2><ol>
<li>将业务逻辑与界面解耦</li>
<li>提升可扩展性, 可测试性, 整洁性和灵活性</li>
<li>M V P三层之间使用接口进行通信, 可以独立变化, 理想化情况是依赖接口实现不同(相同)逻辑适配相同(不同)的界面</li>
<li>使类的职责更加单一, 更易于维护</li>
</ol>
<h2 id="MVP架构"><a href="#MVP架构" class="headerlink" title="MVP架构"></a>MVP架构</h2><p>以技术公司的客户(View), 销售(Presenter), 研发(Model)为模型</p>
<p><img src="/img/MVP架构示意图.svg" alt="MVP架构示意图"></p>
<ol>
<li><p>Presenter - 交互中间人<br>Presenter作为View层和Model层的交互中间人, 同时<strong>拥有View和Model成员变量</strong>, 其犹如一位尽职的销售人员(Presenter), 接受客户的请求(View)并根据请求(View)寻找相应的研发人员(Model)进行开发, 研发人员(Model)开发完成通过销售人员(Presenter)将成果交付给客户(View).</p>
</li>
<li><p>View - 用户界面<br>View通常指Activity, Fragment或者某个View控件, 其<strong>拥有</strong>一个为其服务的<strong>Presenter成员变量</strong>. 其犹如一位公司的老客户(View), 通过为其服务的销售人员(Presenter)获取自己想要的技术需求, 但自己会获取什么质量的需求实现完全依赖于销售(Presenter), 被动.</p>
</li>
<li><p>Model - 业务逻辑<br>对于一个结构化的APP来说, Model的功能主要是运行逻辑, 提供数据, 有些时候Model封装了DAO或者网络访问的功能, 它的成员变量里面<strong>没有View和Presenter</strong>. 其犹如一位加班至深夜的程序员(Model), 不停的接收着来自销售(Presenter)的需求, 不知道这些需求有什么用, 也不知道自己的劳动成果(数据结果)会去往何方.</p>
</li>
</ol>
<h2 id="MVP与MVC和MVVM的区别"><a href="#MVP与MVC和MVVM的区别" class="headerlink" title="MVP与MVC和MVVM的区别"></a>MVP与MVC和MVVM的区别</h2><h3 id="MVC架构"><a href="#MVC架构" class="headerlink" title="MVC架构"></a>MVC架构</h3><ol>
<li>View层可以直接与Controller和Model层直接通信</li>
<li>Controller起到了事件路由的功能</li>
<li>耦合度较高, View, Controller和Model构成了回路</li>
</ol>
<p><img src="/img/MVC架构示意图.svg" alt="MVC架构示意图"></p>
<h3 id="MVVM架构"><a href="#MVVM架构" class="headerlink" title="MVVM架构"></a>MVVM架构</h3><ol>
<li>与MVP非常类似, 只不过View层和ViewModel层是双向绑定, 任何一方发生变化则会反应反应到另外一方</li>
<li>MVP中View的更新则需要通过Presenter</li>
<li>ViewModel角色需要做的只是部分业务逻辑的处理, 以及修改View或者Model的状态</li>
<li>MVVM类似于ListView与Adapter, 数据集之间的关系, ListVew就是View, Adapter就是ViewModel, 数据集就是Model.</li>
</ol>
<p><img src="/img/MVVM架构示意图.svg" alt="MVVM架构示意图"></p>
<h1 id="Jeson-MVP工作流程"><a href="#Jeson-MVP工作流程" class="headerlink" title="Jeson-MVP工作流程"></a>Jeson-MVP工作流程</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>Jeson-MVP除了MVP本身优势之外, 其还可以自动在Model层创建线程池, 使代码在子线程中运行; 而Prensenter层可以自动将Model层得到的数据灵活的在主线程或者子线程中使用; 其还可以自动销毁Presenter的View引用和Model层的线程池, 避免内存泄漏。</p>
<p>项目地址: <a href="https://github.com/SmallHamburger/android-mvp" target="_blank" rel="external">Jeson-Android-MVP</a></p>
<h2 id="运行原理"><a href="#运行原理" class="headerlink" title="运行原理"></a>运行原理</h2><p>Jeson-MVP框架有三个阶段: 初始化阶段、任务处理阶段、销毁阶段。</p>
<p>下面是Jeson<em>MVP</em>时序图, 运行流程如下<br><img src="/img/Jeson_MVP_时序图.svg" alt="Jeson_MVP_时序图"></p>
<h1 id="接口和类"><a href="#接口和类" class="headerlink" title="接口和类"></a>接口和类</h1><p>相关类图如下: </p>
<p><img src="/img/MVP类图.svg" alt="MVP类图"></p>
<h2 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h2><h3 id="IBasicModel"><a href="#IBasicModel" class="headerlink" title="IBasicModel"></a>IBasicModel</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IBasicModel</span> <span class="keyword">extends</span> <span class="title">IBasicHandler</span>, <span class="title">ILifeRecycle</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 设置工作回调</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setWorkCallback</span><span class="params">(IBasicHandler.Callback callback)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="IBasicPresenter"><a href="#IBasicPresenter" class="headerlink" title="IBasicPresenter"></a>IBasicPresenter</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IBasicPresenter</span> <span class="keyword">extends</span> <span class="title">IBasicHandler</span>, <span class="title">ILifeRecycle</span> </span>&#123;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="IBasicView"><a href="#IBasicView" class="headerlink" title="IBasicView"></a>IBasicView</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IBasicView</span></span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 当有新的数据更新时, presentr会调用这个方法</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> data 数据更新时的数据载体</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onDataUpdate</span><span class="params">(Bundle data)</span></span>;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="IBasicHandler"><a href="#IBasicHandler" class="headerlink" title="IBasicHandler"></a>IBasicHandler</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IBasicHandler</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 处理派发下来的任务</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> taskType 任务执行时所需的数据类型</div><div class="line">     * <span class="doctag">@param</span> data     任务执行时所需的数据</div><div class="line">     * <span class="doctag">@param</span> callback 任务执行时执行的回调</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">handleTask</span><span class="params">(Callback callback, <span class="keyword">int</span> taskType, Bundle data)</span></span>;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 获取数据</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> dataType 任务类型, 可根据这个类型获取相应的数据</div><div class="line">     * <span class="doctag">@param</span> data     获取数据时需要传入的参数</div><div class="line">     * <span class="doctag">@return</span> 要获取的数据</div><div class="line">     */</div><div class="line">    <span class="function">Object <span class="title">getData</span><span class="params">(<span class="keyword">int</span> dataType, Bundle data)</span></span>;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 回调接口</div><div class="line">     */</div><div class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">Callback</span></span>&#123;</div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">call</span><span class="params">(<span class="keyword">int</span> dataType, Bundle data)</span></span>;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">onError</span><span class="params">(<span class="keyword">int</span> dataType, Bundle data)</span></span>;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(<span class="keyword">int</span> dataType, Bundle data)</span></span>;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">onFailed</span><span class="params">(<span class="keyword">int</span> dataType, Bundle data)</span></span>;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="ILifeRecycle"><a href="#ILifeRecycle" class="headerlink" title="ILifeRecycle"></a>ILifeRecycle</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * 生命周期接口, 与Activity类似</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ILifeRecycle</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 作用与Activity的onCreate(Bundle bundle)类似, 由presenter或者view层调用</div><div class="line">     * <span class="doctag">@param</span> bundle</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle bundle)</span></span>;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 作用与Activity的onStart类似, 由presenter或者view层调用</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onStart</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 作用与Activity的onResume类似, 由presenter或者view层调用</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onResume</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 作用与Activity的onPause类似, 由presenter或者view层调用</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onPause</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 作用与Activity的onStop类似, 由presenter或者view层调用</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onStop</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 作用与Activity的onDestory类似, 由presenter或者view层调用</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="类"><a href="#类" class="headerlink" title="类"></a>类</h2><h3 id="BasicPresenter"><a href="#BasicPresenter" class="headerlink" title="BasicPresenter"></a>BasicPresenter</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">BasicPresenter</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">IBasicView</span>, <span class="title">K</span> <span class="keyword">extends</span> <span class="title">IBasicModel</span>&gt; <span class="keyword">implements</span> <span class="title">IBasicPresenter</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG = <span class="string">"BasicPresenter"</span>;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 检查自动销毁的间隔</div><div class="line">     */</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> DESTROY_CHECKER_DURATION = <span class="number">1000</span>;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 子线程回调call()时, 使接下来的代码运行在主线程</div><div class="line">     */</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MSG_ON_WORKING_CALLED_ON_UI = <span class="number">0xF0000001</span>;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 子线程回调onSuccess()时, 使接下来的代码运行在主线程</div><div class="line">     */</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MSG_ON_SUCCESS_CALLED_ON_UI = <span class="number">0xF0000002</span>;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 子线程回调onFailed()时, 使接下来的代码运行在主线程</div><div class="line">     */</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MSG_ON_FAILED_CALLED_ON_UI = <span class="number">0xF0000003</span>;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 子线程回调onError()时, 使接下来的代码运行在主线程</div><div class="line">     */</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MSG_ON_ERROR_CALLED_ON_UI = <span class="number">0xF0000004</span>;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 根据线程id保存一个状态, 决定回调是在子线程或者是在主线程运行</div><div class="line">     */</div><div class="line">    <span class="keyword">private</span> Map&lt;Long, Boolean&gt; mCalledStatus;</div><div class="line">    <span class="keyword">private</span> T mBasicView;</div><div class="line">    <span class="keyword">private</span> K mBasicModel;</div><div class="line">    <span class="keyword">private</span> android.os.Handler mUIHandler;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> isDestroyed = <span class="keyword">false</span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BasicPresenter</span><span class="params">(T view, K model)</span> </span>&#123;</div><div class="line">        mBasicView = view;</div><div class="line">        mBasicModel = model;</div><div class="line">        mUIHandler = <span class="keyword">new</span> Handler();</div><div class="line">        mCalledStatus = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">        mBasicModel.setWorkCallback(mWorkCallback);</div><div class="line">        mUIHandler.post(destroyRunnable);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 获取view层</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> view层</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">protected</span> T <span class="title">getBasicView</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> mBasicView;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 获取model层</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> model层</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">protected</span> K <span class="title">getBasicModel</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> mBasicModel;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 获取运行的handler</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span></div><div class="line">     */</div><div class="line">    <span class="keyword">protected</span> android.os.<span class="function">Handler <span class="title">getHandler</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> mUIHandler;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 运行在主线程&lt;br/&gt;</div><div class="line">     * 处理来自model层的消息, 运行在主线程,如果onWorkingCalledOnWorkThread()被重写了, 这个方法便不会运行&lt;br/&gt;</div><div class="line">     * 如果重写了onWorkingCalledOnWorkThread()这个方法, 如果还想使onWorkingCalledOnUIThread()这个方法运行, 则需要调用super.onWorkingCalledOnWorkThread()&lt;br/&gt;</div><div class="line">     * onWorkingCalledOnWorkThread()总是运行在oonWorkingCalledOnUIThread()之前</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> dataType 任务类型, 可根据这个类型获取相应的数据</div><div class="line">     * <span class="doctag">@param</span> data     获取数据时需要传入的参数</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onWorkingCalledOnUIThread</span><span class="params">(<span class="keyword">int</span> dataType, Bundle data)</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 运行在子线程&lt;br/&gt;</div><div class="line">     * 处理来自model层的消息, 运行在子线程, 当这个方法被重写时onWorkingCalledOnUIThread()方法不再运行&lt;br/&gt;</div><div class="line">     * 不需要调用super.onWorkingCalledOnWorkThread(dataType, data), 除非你想在这个方法运行完成之后继续运行onWorkingCalledOnUIThread(dataType, data)方法</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> dataType 任务类型, 可根据这个类型获取相应的数据</div><div class="line">     * <span class="doctag">@param</span> data     获取数据时需要传入的参数</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onWorkingCalledOnWorkThread</span><span class="params">(<span class="keyword">int</span> dataType, Bundle data)</span> </span>&#123;</div><div class="line">        mCalledStatus.put(Thread.currentThread().getId(), <span class="keyword">true</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 使用方法参考onWorkingCalledOnUIThread(int dataType, Bundle data)方法</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onSuccessCalledOnUIThread</span><span class="params">(<span class="keyword">int</span> dataType, Bundle data)</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 使用方法参考onWorkingCalledOnWorkThread(int dataType, Bundle data)方法</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onSuccessCalledOnWorkThread</span><span class="params">(<span class="keyword">int</span> dataType, Bundle data)</span> </span>&#123;</div><div class="line">        mCalledStatus.put(Thread.currentThread().getId(), <span class="keyword">true</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onFailedCalledOnWorkThread</span><span class="params">(<span class="keyword">int</span> dataType, Bundle data)</span> </span>&#123;</div><div class="line">        mCalledStatus.put(Thread.currentThread().getId(), <span class="keyword">true</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onFailedCalledOnUIThread</span><span class="params">(<span class="keyword">int</span> dataType, Bundle data)</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onErrorCalledOnWorkThread</span><span class="params">(<span class="keyword">int</span> dataType, Bundle data)</span> </span>&#123;</div><div class="line">        mCalledStatus.put(Thread.currentThread().getId(), <span class="keyword">true</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onErrorCalledOnUIThread</span><span class="params">(<span class="keyword">int</span> dataType, Bundle data)</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 处理消息, 与handler中的handleMessage(Message msg)作用一致, 运行在主线程</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> msg</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 用于model层的工作回调</div><div class="line">     */</div><div class="line">    <span class="keyword">protected</span> IBasicHandler.Callback mWorkCallback = <span class="keyword">new</span> Callback() &#123;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(<span class="keyword">int</span> dataType, Bundle data)</span> </span>&#123;</div><div class="line">            mCalledStatus.put(Thread.currentThread().getId(), <span class="keyword">false</span>);</div><div class="line">            onWorkingCalledOnWorkThread(dataType, data);</div><div class="line">            <span class="keyword">if</span> (mCalledStatus.get(Thread.currentThread().getId())) &#123;</div><div class="line">                Message.obtain(mUIHandler, MSG_ON_WORKING_CALLED_ON_UI, dataType, <span class="number">0</span>, data).sendToTarget();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(<span class="keyword">int</span> dataType, Bundle data)</span> </span>&#123;</div><div class="line">            mCalledStatus.put(Thread.currentThread().getId(), <span class="keyword">false</span>);</div><div class="line">            onSuccessCalledOnWorkThread(dataType, data);</div><div class="line">            <span class="keyword">if</span> (mCalledStatus.get(Thread.currentThread().getId())) &#123;</div><div class="line">                Message.obtain(mUIHandler, MSG_ON_SUCCESS_CALLED_ON_UI, dataType, <span class="number">0</span>, data).sendToTarget();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailed</span><span class="params">(<span class="keyword">int</span> dataType, Bundle data)</span> </span>&#123;</div><div class="line">            mCalledStatus.put(Thread.currentThread().getId(), <span class="keyword">false</span>);</div><div class="line">            onFailedCalledOnWorkThread(dataType, data);</div><div class="line">            <span class="keyword">if</span> (mCalledStatus.get(Thread.currentThread().getId())) &#123;</div><div class="line">                Message.obtain(mUIHandler, MSG_ON_FAILED_CALLED_ON_UI, dataType, <span class="number">0</span>, data).sendToTarget();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(<span class="keyword">int</span> dataType, Bundle data)</span> </span>&#123;</div><div class="line">            mCalledStatus.put(Thread.currentThread().getId(), <span class="keyword">false</span>);</div><div class="line">            onErrorCalledOnWorkThread(dataType, data);</div><div class="line">            <span class="keyword">if</span> (mCalledStatus.get(Thread.currentThread().getId())) &#123;</div><div class="line">                Message.obtain(mUIHandler, MSG_ON_ERROR_CALLED_ON_UI, dataType, <span class="number">0</span>, data).sendToTarget();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> Runnable destroyRunnable = <span class="keyword">new</span> Runnable() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">            <span class="keyword">if</span> (!isDestroyed &amp;&amp; mBasicView != <span class="keyword">null</span>) &#123;</div><div class="line">                <span class="keyword">boolean</span> isDestroyed = <span class="keyword">false</span>;</div><div class="line">                <span class="keyword">do</span> &#123;</div><div class="line">                    <span class="keyword">if</span> (mBasicView <span class="keyword">instanceof</span> Activity) &#123;</div><div class="line">                        isDestroyed = ((Activity) mBasicView).isFinishing();</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    &#125;</div><div class="line">                    <span class="keyword">if</span> (mBasicView <span class="keyword">instanceof</span> Fragment) &#123;</div><div class="line">                        Activity activity = ((Fragment) mBasicView).getActivity();</div><div class="line">                        <span class="keyword">if</span> (activity != <span class="keyword">null</span>) &#123;</div><div class="line">                            isDestroyed = activity.isFinishing();</div><div class="line">                            <span class="keyword">break</span>;</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                    <span class="keyword">if</span> (mBasicView <span class="keyword">instanceof</span> View) &#123;</div><div class="line">                        Context context = ((View) mBasicView).getContext();</div><div class="line">                        <span class="keyword">if</span> (context != <span class="keyword">null</span> &amp;&amp; context <span class="keyword">instanceof</span> Activity) &#123;</div><div class="line">                            isDestroyed = ((Activity) context).isFinishing();</div><div class="line">                            <span class="keyword">break</span>;</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                &#125; <span class="keyword">while</span> (<span class="keyword">false</span>);</div><div class="line">                <span class="keyword">if</span> (isDestroyed) &#123;</div><div class="line">                    onDestroy();</div><div class="line">                    Log.i(TAG, <span class="string">"View is destroyed, presenter and model have been auto destroyed also"</span>);</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    getHandler().postDelayed(<span class="keyword">this</span>, DESTROY_CHECKER_DURATION);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Handler</span> <span class="keyword">extends</span> <span class="title">android</span>.<span class="title">os</span>.<span class="title">Handler</span> </span>&#123;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">private</span> <span class="title">Handler</span><span class="params">()</span> </span>&#123;</div><div class="line">            <span class="keyword">super</span>(Looper.getMainLooper());</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span> </span>&#123;</div><div class="line">            <span class="keyword">switch</span> (msg.what) &#123;</div><div class="line">                <span class="keyword">case</span> BasicPresenter.MSG_ON_WORKING_CALLED_ON_UI:</div><div class="line">                    onWorkingCalledOnUIThread(msg.arg1, (Bundle) msg.obj);</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                <span class="keyword">case</span> BasicPresenter.MSG_ON_SUCCESS_CALLED_ON_UI:</div><div class="line">                    onSuccessCalledOnUIThread(msg.arg1, (Bundle) msg.obj);</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                <span class="keyword">case</span> BasicPresenter.MSG_ON_FAILED_CALLED_ON_UI:</div><div class="line">                    onFailedCalledOnUIThread(msg.arg1, (Bundle) msg.obj);</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                <span class="keyword">case</span> BasicPresenter.MSG_ON_ERROR_CALLED_ON_UI:</div><div class="line">                    onErrorCalledOnUIThread(msg.arg1, (Bundle) msg.obj);</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                <span class="keyword">default</span>:</div><div class="line">                    BasicPresenter.<span class="keyword">this</span>.handleMessage(msg);</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle bundle)</span> </span>&#123;</div><div class="line">        mBasicModel.onCreate(bundle);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onResume</span><span class="params">()</span> </span>&#123;</div><div class="line">        mBasicModel.onResume();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPause</span><span class="params">()</span> </span>&#123;</div><div class="line">        mBasicModel.onPause();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStart</span><span class="params">()</span> </span>&#123;</div><div class="line">        mBasicModel.onStart();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStop</span><span class="params">()</span> </span>&#123;</div><div class="line">        mBasicModel.onStop();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (!isDestroyed) &#123;</div><div class="line">            isDestroyed = <span class="keyword">true</span>;</div><div class="line">            mBasicModel.onDestroy();</div><div class="line">            mBasicView = <span class="keyword">null</span>;</div><div class="line">            mBasicModel = <span class="keyword">null</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleTask</span><span class="params">(IBasicHandler.Callback callback, <span class="keyword">int</span> taskType, Bundle data)</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getData</span><span class="params">(<span class="keyword">int</span> dataType, Bundle data)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">protected</span> <span class="class"><span class="keyword">class</span> <span class="title">Callback</span> <span class="keyword">implements</span> <span class="title">IBasicHandler</span>.<span class="title">Callback</span> </span>&#123;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(<span class="keyword">int</span> dataType, Bundle data)</span> </span>&#123;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(<span class="keyword">int</span> dataType, Bundle data)</span> </span>&#123;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(<span class="keyword">int</span> dataType, Bundle data)</span> </span>&#123;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailed</span><span class="params">(<span class="keyword">int</span> dataType, Bundle data)</span> </span>&#123;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="BasicModel"><a href="#BasicModel" class="headerlink" title="BasicModel"></a>BasicModel</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">BasicModel</span> <span class="keyword">implements</span> <span class="title">IBasicModel</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG = <span class="string">"BasicModel"</span>;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 自动调整线程数量</div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> CACHED_THREAD = <span class="number">0</span>;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 单线程</div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> SINGLE_THREAD = <span class="number">1</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> isDestroyed = <span class="keyword">false</span>;</div><div class="line">    <span class="keyword">private</span> ExecutorService mExecutorService;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 用于子类传送消息, 运行在主线程, handleMessage()会推送至线程池中运行</div><div class="line">     */</div><div class="line">    <span class="keyword">private</span> Handler mWorkHandler;</div><div class="line">    <span class="keyword">private</span> IBasicHandler.Callback mWorkingCallback;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 默认model层开启1个子线程</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BasicModel</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>(SINGLE_THREAD);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 可以根据给的线程数量设置model层子线程数量, 如果参数值为CACHED_THREAD, 则使用自动调整线程数量, 如果参数值为SINGLE_THREAD, 则为单线程, 如果是其他值则使用指定的线程数量</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> nThreads</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BasicModel</span><span class="params">(<span class="keyword">int</span> nThreads)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (nThreads == CACHED_THREAD) &#123;</div><div class="line">            mExecutorService = Executors.newCachedThreadPool();</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nThreads == SINGLE_THREAD) &#123;</div><div class="line">            mExecutorService = Executors.newSingleThreadExecutor();</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            mExecutorService = Executors.newFixedThreadPool(nThreads);</div><div class="line">        &#125;</div><div class="line">        mWorkHandler = <span class="keyword">new</span> Handler();</div><div class="line">        <span class="comment">//从任务队列中读取任务交给线程去执行</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">protected</span> android.os.<span class="function">Handler <span class="title">getWorkHandler</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> mWorkHandler;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setWorkCallback</span><span class="params">(Callback callback)</span> </span>&#123;</div><div class="line">        mWorkingCallback = callback;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">protected</span> IBasicHandler.<span class="function">Callback <span class="title">getWorkingCallback</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> mWorkingCallback;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span></span>;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle bundle)</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStart</span><span class="params">()</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onResume</span><span class="params">()</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPause</span><span class="params">()</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStop</span><span class="params">()</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (!isDestroyed) &#123;</div><div class="line">            isDestroyed = <span class="keyword">true</span>; <span class="comment">//标记当前状态为destroyed</span></div><div class="line">            mExecutorService.shutdownNow(); <span class="comment">//关闭线程池</span></div><div class="line">            mExecutorService = <span class="keyword">null</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleTask</span><span class="params">(Callback callback, <span class="keyword">int</span> taskType, Bundle data)</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getData</span><span class="params">(<span class="keyword">int</span> dataType, Bundle data)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Runnable</span> <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">lang</span>.<span class="title">Runnable</span> </span>&#123;</div><div class="line">        <span class="keyword">private</span> Message msg;</div><div class="line"></div><div class="line">        Runnable(Message msg) &#123;</div><div class="line">            <span class="keyword">this</span>.msg = msg;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">            <span class="keyword">if</span> (!isDestroyed) &#123;</div><div class="line">                handleMessage(msg);</div><div class="line">            &#125;</div><div class="line">            msg.recycle();<span class="comment">// Message对象没有经过Looper循环, 需要手动回收</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Handler</span> <span class="keyword">extends</span> <span class="title">android</span>.<span class="title">os</span>.<span class="title">Handler</span> </span>&#123;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Handler</span><span class="params">()</span> </span>&#123;</div><div class="line">            <span class="keyword">super</span>(Looper.getMainLooper());</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dispatchMessage</span><span class="params">(Message msg)</span> </span>&#123;</div><div class="line">            <span class="keyword">if</span> (!isDestroyed) &#123;</div><div class="line">                <span class="keyword">if</span> (msg.getCallback() != <span class="keyword">null</span>) &#123;</div><div class="line">                    <span class="comment">// Looper会自动回收Message对象</span></div><div class="line">                    mExecutorService.execute(msg.getCallback());</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    <span class="comment">// Looper会自动回收msg对象, 所以需要一个新的Message对象供我们的子线程使用</span></div><div class="line">                    mExecutorService.execute(<span class="keyword">new</span> Runnable(Message.obtain(msg)));</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

        </div>

        <blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2017-06-04T09:07:15.113Z" itemprop="dateUpdated">2017-06-04 17:07:15</time>
</span><br>


        
    </div>
    <footer>
        <a href="http://jeson.org">
            <img src="/img/avatar.jpg" alt="会飞的汉堡包">
            会飞的汉堡包
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVP/">MVP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/">java</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://jeson.org/2017/06/02/Jeson-Android-MVP基本框架/&title=《Jeson Android MVP》 — 学习笔记&pic=http://jeson.org/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://jeson.org/2017/06/02/Jeson-Android-MVP基本框架/&title=《Jeson Android MVP》 — 学习笔记&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://jeson.org/2017/06/02/Jeson-Android-MVP基本框架/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Jeson Android MVP》 — 学习笔记&url=http://jeson.org/2017/06/02/Jeson-Android-MVP基本框架/&via=http://jeson.org" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://jeson.org/2017/06/02/Jeson-Android-MVP基本框架/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between flex-row-reverse">
  

  
    <div class="waves-block waves-effect next">
      <a href="/2017/04/25/笔记-JavaWeb(一)/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">笔记-JavaWeb (一)</h4>
      </a>
    </div>
  
</nav>



    
















</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢大爷~
        <i class="icon icon-quote-right"></i>
    </h3>
    <ul class="reward-items">
        

        
    </ul>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p style="display:none;">
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>博客内容遵循<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
        </p>
    </div>
    <div class="bottom">
        <p>
            <span style="display:none;">Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a></span>
            <span>会飞的汉堡包 &copy; 2016 - 2017</span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://jeson.org/2017/06/02/Jeson-Android-MVP基本框架/&title=《Jeson Android MVP》 — 学习笔记&pic=http://jeson.org/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://jeson.org/2017/06/02/Jeson-Android-MVP基本框架/&title=《Jeson Android MVP》 — 学习笔记&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://jeson.org/2017/06/02/Jeson-Android-MVP基本框架/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Jeson Android MVP》 — 学习笔记&url=http://jeson.org/2017/06/02/Jeson-Android-MVP基本框架/&via=http://jeson.org" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://jeson.org/2017/06/02/Jeson-Android-MVP基本框架/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACJElEQVR42u3aQW6EMAwF0Ln/pem2Usv028lUwnlZIQQhj4UVx3694nHdjPdPfr/z85m767uZNwwMDIzHMq63I3lmnZTA/vgiBgbGAYy7Rby/TuJeFZB8CwMDAyPfwCXU5F0MDAyMvYwk1CYz51tSDAwMjOp0eQB9/1N682/IxTEwMB7IyE/d///6I/UNDAyMRzGu4qgWNash8moNDAyM2YxegpoHxGqbxUrCjIGBcQJj86StY7gk3Y2O2zAwMA5jVNspcsyuMioGBsZsxt7mrV7xMt9K3t7HwMAYzdgVs/MiaK+ZLFktBgbGVEb+yd6Gb/04LwrlGBgYBzCSpa8E3Lz82Sw8YGBgjGbkiWW+gVt5vprcYmBgnMCoLr26WVzZMuaNGhgYGLMZ1ZSyeijWO3pbKRhgYGDMY/Re64XUvWWDX3JxDAyMoYyVLVpyGJekrAk7OXrDwMCYyugd/eclzE8UR6MSJgYGxiBG3hyWg/MWil7bx1KPGwYGxmMZK8lk/p+qAb06JwYGxgmMfOrqhq9aSKimuxgYGOcw8gSy19qVp6m9wioGBsZUxlUceVmxmtwulTMxMDBGM/KRL67abJG8tdTjhoGBMYKxHmR7R2/VhoyoeImBgTGakXdb9WaoBtNmKouBgYFRbN6qbg3LZctdARcDA2Mco1do7LVoFBJgDAyMAxgrh/XVOysJ8O2cGBgYoxl56riejvZ+TY+KgYExgvEFEHzRP6wWYYMAAAAASUVORK5CYII=" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };



</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>



<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" async></script>




<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '会飞的汉堡包';
            clearTimeout(titleTime);
        } else {
            document.title = '会飞的汉堡包';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
